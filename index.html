<!DOCTYPE html>
<html>
<head>
    <title>Blueprint Creator</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f4f8;
        }
        .container {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .tools {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 250px;
        }
        .canvas-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            flex-grow: 1;
            position: relative;
        }
        canvas {
            background: #fff;
            border: 1px solid #e0e0e0;
            cursor: crosshair;
        }
        .tool-button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .tool-button:hover {
            background: #1d4ed8;
        }
        .tool-button.active {
            background: #1e40af;
        }
        .input-group {
            margin: 15px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #4b5563;
        }
        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
        }
        .coordinates {
            position: absolute;
            bottom: 10px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            color: #4b5563;
        }
        .section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tools">
            <div class="section">
                <h3>Drawing Tools</h3>
                <button id="wallBtn" class="tool-button active">Wall</button>
                <button id="doorBtn" class="tool-button">Door</button>
                <button id="windowBtn" class="tool-button">Window</button>
            </div>
            
            <div class="section">
                <h3>Properties</h3>
                <div class="input-group">
                    <label>Wall Thickness (inches)</label>
                    <input type="number" id="wallThickness" value="6" min="4" max="12">
                </div>
                <div class="input-group">
                    <label>Door Width (feet)</label>
                    <input type="number" id="doorWidth" value="3" min="2" max="6">
                </div>
                <div class="input-group">
                    <label>Window Width (feet)</label>
                    <input type="number" id="windowWidth" value="3" min="2" max="6">
                </div>
            </div>

            <div class="section">
                <h3>Grid Settings</h3>
                <div class="input-group">
                    <label>Grid Size (feet)</label>
                    <input type="number" id="gridSize" value="1" min="0.5" max="5" step="0.5">
                </div>
            </div>

            <button id="clearBtn" class="tool-button" style="background: #dc2626;">Clear All</button>
            <button id="undoBtn" class="tool-button" style="background: #4b5563;">Undo</button>
        </div>

        <div class="canvas-container">
            <canvas id="canvas"></canvas>
            <div class="coordinates" id="coordinates">0, 0</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const SCALE = 20; // 1 foot = 20 pixels
        let currentTool = 'wall';
        let isDrawing = false;
        let startX, startY;
        let elements = [];
        let undoHistory = [];

        // Set canvas size
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth - 42; // Adjust for padding
            canvas.height = window.innerHeight - 100;
            redraw();
        }

        // Initialize canvas size
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Tool selection
        document.querySelectorAll('.tool-button').forEach(button => {
            if (!button.id.includes('Btn')) return;
            button.addEventListener('click', () => {
                if (button.id === 'clearBtn') {
                    elements = [];
                    redraw();
                    return;
                }
                if (button.id === 'undoBtn') {
                    if (elements.length > 0) {
                        undoHistory.push(elements.pop());
                        redraw();
                    }
                    return;
                }
                document.querySelectorAll('.tool-button').forEach(b => b.classList.remove('active'));
                button.classList.add('active');
                currentTool = button.id.replace('Btn', '');
            });
        });

        // Mouse event handlers
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mousemove', updateCoordinates);

        function getMousePos(e) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }

        function snapToGrid(value) {
            const gridPixels = Number(document.getElementById('gridSize').value) * SCALE;
            return Math.round(value / gridPixels) * gridPixels;
        }

        function updateCoordinates(e) {
            const pos = getMousePos(e);
            const x = (pos.x / SCALE).toFixed(1);
            const y = (pos.y / SCALE).toFixed(1);
            document.getElementById('coordinates').textContent = `${x}', ${y}'`;
        }

        function startDrawing(e) {
            isDrawing = true;
            const pos = getMousePos(e);
            startX = snapToGrid(pos.x);
            startY = snapToGrid(pos.y);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const pos = getMousePos(e);
            const currentX = snapToGrid(pos.x);
            const currentY = snapToGrid(pos.y);
            
            redraw();
            
            // Preview current drawing
            switch(currentTool) {
                case 'wall':
                    drawWall(startX, startY, currentX, currentY);
                    break;
                case 'door':
                    drawDoor(startX, startY, currentX, currentY);
                    break;
                case 'window':
                    drawWindow(startX, startY, currentX, currentY);
                    break;
            }
        }

        function stopDrawing(e) {
            if (!isDrawing) return;
            
            const pos = getMousePos(e);
            const endX = snapToGrid(pos.x);
            const endY = snapToGrid(pos.y);
            
            // Add new element
            elements.push({
                type: currentTool,
                x1: startX,
                y1: startY,
                x2: endX,
                y2: endY
            });
            
            isDrawing = false;
            redraw();
        }

        function drawWall(x1, y1, x2, y2) {
            const thickness = Number(document.getElementById('wallThickness').value) / 12 * SCALE;
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.strokeStyle = '#000';
            ctx.lineWidth = thickness;
            ctx.stroke();
        }

        function drawDoor(x1, y1, x2, y2) {
            const width = Number(document.getElementById('doorWidth').value) * SCALE;
            const direction = x2 > x1 ? 1 : -1;
            
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x1 + width * direction, y1);
            ctx.strokeStyle = '#ff0000';
            ctx.lineWidth = 2;
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(x1, y1, width, 0, Math.PI/2 * direction, direction < 0);
            ctx.stroke();
        }

        function drawWindow(x1, y1, x2, y2) {
            const width = Number(document.getElementById('windowWidth').value) * SCALE;
            const height = width / 2;
            
            ctx.strokeStyle = '#0000ff';
            ctx.lineWidth = 2;
            
            ctx.strokeRect(x1, y1, width, height);
            
            // Window cross
            ctx.beginPath();
            ctx.moveTo(x1 + width/2, y1);
            ctx.lineTo(x1 + width/2, y1 + height);
            ctx.moveTo(x1, y1 + height/2);
            ctx.lineTo(x1 + width, y1 + height/2);
            ctx.stroke();
        }

        function drawGrid() {
            const gridSize = Number(document.getElementById('gridSize').value) * SCALE;
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 0.5;
            
            for(let x = 0; x <= canvas.width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            for(let y = 0; y <= canvas.height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }

        function redraw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawGrid();
            elements.forEach(element => {
                switch(element.type) {
                    case 'wall':
                        drawWall(element.x1, element.y1, element.x2, element.y2);
                        break;
                    case 'door':
                        drawDoor(element.x1, element.y1, element.x2, element.y2);
                        break;
                    case 'window':
                        drawWindow(element.x1, element.y1, element.x2, element.y2);
                        break;
                }
            });
        }

        // Initial draw
        redraw();
    </script>
</body>
</html>
